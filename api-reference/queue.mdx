---
title: "Queue Management"
description: "Manage background jobs and queue processing for PIX payments and webhooks"
---

# Queue Management API

The Queue Management API allows you to manage background jobs for PIX payments, webhooks, and other asynchronous operations. This section covers queue-related endpoints.

## Add Credit Job

Add a credit job to the queue for processing PIX payments.

<RequestExample>
```bash cURL
curl -X POST "https://api.pinepay.com/api/queue/credit" \
  -H "Authorization: Bearer your_api_key_here" \
  -H "Content-Type: application/json" \
  -d '{
    "pixInId": "pix_123456789",
    "gateway": "woovi",
    "webhookData": {
      "endToEndId": "E12345678202401151234567890",
      "amount": 10.50
    },
    "searchIdentifiers": {
      "txId": "tx_123456789",
      "endToEndId": "E12345678202401151234567890"
    }
  }'
```
</RequestExample>

<ResponseExample>
```json Success
{
  "success": true,
  "message": "Credit job added to queue",
  "data": {
    "messageId": "msg_123456789",
    "queueName": "creditUserBalance",
    "jobName": "creditUserBalance"
  }
}
```
</ResponseExample>

### Parameters

<ParamField body="pixInId" type="string" required>
The PIX IN transaction ID to credit.
</ParamField>

<ParamField body="gateway" type="string" required>
The payment gateway used for this transaction.
</ParamField>

<ParamField body="webhookData" type="object">
Webhook data associated with the credit operation.
</ParamField>

<ParamField body="searchIdentifiers" type="object">
Identifiers to search for the transaction in the database.
</ParamField>

## Add Webhook Job

Add a webhook job to the queue for processing webhook notifications.

<RequestExample>
```bash cURL
curl -X POST "https://api.pinepay.com/api/queue/webhook" \
  -H "Authorization: Bearer your_api_key_here" \
  -H "Content-Type: application/json" \
  -d '{
    "webhookUrl": "https://your-domain.com/webhooks/pinepay",
    "payload": {
      "type": "PAYMENT_RECEIVED",
      "data": {
        "transactionId": "tx_123456789",
        "amount": 10.50
      }
    },
    "externalId": "order_123",
    "gateway": "woovi",
    "priority": "high"
  }'
```
</RequestExample>

<ResponseExample>
```json Success
{
  "success": true,
  "message": "Webhook job added to queue",
  "data": {
    "messageId": "msg_123456789",
    "queueName": "webhookProcessing",
    "jobName": "processWebhook"
  }
}
```
</ResponseExample>

### Parameters

<ParamField body="webhookUrl" type="string" required>
The webhook URL to send the notification to.
</ParamField>

<ParamField body="payload" type="object" required>
The webhook payload data to send.
</ParamField>

<ParamField body="externalId" type="string" required>
External reference ID for this webhook.
</ParamField>

<ParamField body="gateway" type="string" required>
The payment gateway associated with this webhook.
</ParamField>

<ParamField body="priority" type="string" default="normal">
Job priority: `low`, `normal`, `high`.
</ParamField>

## Add Transfer Job

Add a transfer job to the queue for processing PIX transfers.

<RequestExample>
```bash cURL
curl -X POST "https://api.pinepay.com/api/queue/transfer" \
  -H "Authorization: Bearer your_api_key_here" \
  -H "Content-Type: application/json" \
  -d '{
    "transferData": {
      "pixOutId": "pix_out_123456789",
      "endToEndId": "E12345678202401151234567890",
      "amount": 10.50,
      "pixKey": "user@example.com",
      "gateway": "woovi"
    }
  }'
```
</RequestExample>

<ResponseExample>
```json Success
{
  "success": true,
  "message": "Transfer job added to queue",
  "data": {
    "messageId": "msg_123456789",
    "queueName": "pixTransfer",
    "jobName": "processPixTransfer"
  }
}
```
</ResponseExample>

### Parameters

<ParamField body="transferData" type="object" required>
Transfer data containing PIX OUT transaction details.
</ParamField>

## Add Withdrawal Job

Add a withdrawal job to the queue for processing PIX withdrawals.

<RequestExample>
```bash cURL
curl -X POST "https://api.pinepay.com/api/queue/withdrawal" \
  -H "Authorization: Bearer your_api_key_here" \
  -H "Content-Type: application/json" \
  -d '{
    "withdrawalData": {
      "pixOutId": "pix_out_123456789",
      "amount": 10.50,
      "pixKey": "user@example.com",
      "gateway": "woovi",
      "externalId": "withdrawal_123"
    }
  }'
```
</RequestExample>

<ResponseExample>
```json Success
{
  "success": true,
  "message": "Withdrawal job added to queue",
  "data": {
    "messageId": "msg_123456789",
    "queueName": "pixWithdrawal",
    "jobName": "processPixWithdrawal"
  }
}
```
</ResponseExample>

### Parameters

<ParamField body="withdrawalData" type="object" required>
Withdrawal data containing PIX withdrawal transaction details.
</ParamField>

## Add Infraction Job

Add an infraction job to the queue for processing PIX infractions.

<RequestExample>
```bash cURL
curl -X POST "https://api.pinepay.com/api/queue/infraction" \
  -H "Authorization: Bearer your_api_key_here" \
  -H "Content-Type: application/json" \
  -d '{
    "infractionData": {
      "pixInId": "pix_123456789",
      "endToEndId": "E12345678202401151234567890",
      "amount": 10.50,
      "infractionId": "inf_123456789",
      "reportDetails": "Suspicious transaction pattern",
      "gateway": "treeal"
    }
  }'
```
</RequestExample>

<ResponseExample>
```json Success
{
  "success": true,
  "message": "Infraction job added to queue",
  "data": {
    "messageId": "msg_123456789",
    "queueName": "infractionProcessing",
    "jobName": "processInfraction"
  }
}
```
</ResponseExample>

### Parameters

<ParamField body="infractionData" type="object" required>
Infraction data containing PIX infraction details.
</ParamField>

## Publish Message

Publish a message directly to a specific queue.

<RequestExample>
```bash cURL
curl -X POST "https://api.pinepay.com/api/queue/publish" \
  -H "Authorization: Bearer your_api_key_here" \
  -H "Content-Type: application/json" \
  -d '{
    "queueName": "customQueue",
    "message": {
      "type": "CUSTOM_EVENT",
      "data": {
        "customField": "customValue"
      }
    },
    "options": {
      "priority": "high",
      "delay": 5000
    }
  }'
```
</RequestExample>

<ResponseExample>
```json Success
{
  "success": true,
  "message": "Message published to queue",
  "data": {
    "messageId": "msg_123456789",
    "queueName": "customQueue"
  }
}
```
</ResponseExample>

### Parameters

<ParamField body="queueName" type="string" required>
The name of the queue to publish the message to.
</ParamField>

<ParamField body="message" type="object" required>
The message payload to publish.
</ParamField>

<ParamField body="options" type="object">
Additional options for message publishing.
</ParamField>

## Queue Status

Get the current status of all queues.

<RequestExample>
```bash cURL
curl -X GET "https://api.pinepay.com/api/queue/status" \
  -H "Authorization: Bearer your_api_key_here"
```
</RequestExample>

<ResponseExample>
```json Success
{
  "success": true,
  "data": {
    "queues": [
      {
        "name": "creditUserBalance",
        "pending": 5,
        "processing": 2,
        "completed": 150,
        "failed": 3
      },
      {
        "name": "webhookProcessing",
        "pending": 10,
        "processing": 1,
        "completed": 200,
        "failed": 5
      }
    ],
    "totalJobs": 375,
    "activeWorkers": 3
  }
}
```
</ResponseExample>

## Error Responses

<ResponseField name="400 Bad Request" type="object">
  Returned when request parameters are invalid.

  <Expandable title="Error Response">
    ```json
    {
      "success": false,
      "message": "Validation failed",
      "errors": [
        {
          "field": "pixInId",
          "message": "pixInId is required"
        }
      ]
    }
    ```
  </Expandable>
</ResponseField>

<ResponseField name="500 Internal Server Error" type="object">
  Returned when queue operations fail.

  <Expandable title="Error Response">
    ```json
    {
      "success": false,
      "message": "Failed to add job to queue",
      "error": "Queue connection failed"
    }
    ```
  </Expandable>
</ResponseField>
